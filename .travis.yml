language: node_js
sudo: false
node_js:
- '8'
cache:
  directories:
  - node_modules/

script:
  - npm test -- --coverage # Include coverage when running tests
  - npm run build

after_script: # Upload coverage reports
  - npm run coveralls # remember to st COVERALLS_REPO_TOKEN

before_deploy:
  - pushd functions && npm install && popd
  - npm run build

deploy:
  - provider: firebase
    skip_cleanup: true
    token: "$FIREBASE_TOKEN"
